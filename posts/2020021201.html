<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
    <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="Horace">




    <meta name="keywords" content="zhaohaihao,èµµæµ·è±ª,æµ·è±ª,Horace,Horace's Blog,æµ·è±ªçš„åšå®¢,Java,åç«¯">



    <title>è®¾è®¡æ¨¡å¼ä¹‹åˆ›å»ºå‹-å•ä¾‹æ¨¡å¼ (Singleton) | Horace&#39;s Blog</title>
    



    <link rel="icon" href="https://www.zhaohaihao.com/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="https://www.zhaohaihao.com/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="https://www.zhaohaihao.com/js/script.js"></script>
    
    <script src="https://www.zhaohaihao.com/js/tocbot.min.js"></script>
    
    <script src="https://www.zhaohaihao.com/js/custom.js"></script>
    



    
    
        
    


    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="https://www.zhaohaihao.com/atom.xml" title="Horace" type="application/atom+xml">
</head>
<body>
	<script type="text/javascript" src="/js/canvas-colorful-nest.js"></script>
    <div class="wrapper">
        <header>
    
        <nav class="navbar">
            <div class="container">
                <div class="navbar-header header-logo"><a href="https://www.zhaohaihao.com/">Horace&#39;s Blog</a></div>
                <div class="menu navbar-right">
                    
                        <a class="menu-item" href="https://www.zhaohaihao.com/archives">å½’æ¡£</a>
                    
                        <a class="menu-item" href="https://www.zhaohaihao.com/categories">åˆ†ç±»</a>
                    
                        <a class="menu-item" href="https://www.zhaohaihao.com/tags">æ ‡ç­¾</a>
                    
                        <a class="menu-item" href="https://www.zhaohaihao.com/links">å‹é“¾</a>
                    
                        <a class="menu-item" href="https://www.zhaohaihao.com/about">å…³äº</a>
                    
                    <input id="switch_default" type="checkbox" class="switch_default">
                    <label for="switch_default" class="toggleBtn"></label>
                </div>
            </div>
        </nav>

        
        <nav class="navbar-mobile" id="nav-mobile">
            <div class="container">
                <div class="navbar-header">
                    <div>
                        <a href="https://www.zhaohaihao.com/">Horace&#39;s Blog</a>
                    </div>
                    <div style="display: inherit;">
                        <div><a id="mobile-toggle-theme">Light</a></div>
                        <div class="menu-toggle" onclick="mobileBtn()" style="padding-left: 15px;">&#9776;èœå•</div>
                    </div>
                    
                </div>
                <div class="menu" id="mobile-menu">
                    
                        <a class="menu-item" href="https://www.zhaohaihao.com/archives">å½’æ¡£</a>
                    
                        <a class="menu-item" href="https://www.zhaohaihao.com/categories">åˆ†ç±»</a>
                    
                        <a class="menu-item" href="https://www.zhaohaihao.com/tags">æ ‡ç­¾</a>
                    
                        <a class="menu-item" href="https://www.zhaohaihao.com/links">å‹é“¾</a>
                    
                        <a class="menu-item" href="https://www.zhaohaihao.com/about">å…³äº</a>
                    
                </div>
            </div>
        </nav>
    
</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
           mobileMenu.classList.remove("active")
        }else{
           toggleMenu.classList.add("active")
           mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <!--<a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>-->
        <a onclick="go_top()">è¿”å›é¡µé¦–</a>
        <a onclick="go_bottom()">è½¬åˆ°åº•éƒ¨</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">è®¾è®¡æ¨¡å¼ä¹‹åˆ›å»ºå‹-å•ä¾‹æ¨¡å¼ (Singleton)</h1>
            
                <div class="post-meta">
                    <i class="iconfont icon-calendar"></i> å‘è¡¨äº 2020-02-12
                    &nbsp;|&nbsp;
                    
                        <span class="post-category">
                        <i class="iconfont icon-folder"></i> åˆ†ç±»äº 
                            
                                <a href="https://www.zhaohaihao.com/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"> è®¾è®¡æ¨¡å¼</a>
                            
                        </span>
                    &nbsp;|&nbsp;
                    
                    <span id="busuanzi_container_page_pv">
                    <i class="iconfont icon-eye"></i> é˜…è¯»é‡ <span id="busuanzi_value_page_pv"></span> æ¬¡
                    </span>

                    <!-- | 
                    3.3k å­—
                     |
                    12 åˆ†é’Ÿ
                    -->
                <!--
                    
                        <a itemprop="author" rel="author" href="/">Horace</a> 
                    

                    
                        <span class="post-time">
                        å‘å¸ƒäº <a href="#">02-12&nbsp;14:11:55</a> ,
                        </span>
                    
                    
                        <span class="post-category">
                            
                                <a href="https://www.zhaohaihao.com/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"># è®¾è®¡æ¨¡å¼</a>
                            
                        </span>
                    
                -->
                </div>
            
        </header>

        <div class="post-content">
            <p><a href="https://emojipedia.org/backhand-index-pointing-right/" target="_blank" rel="noopener">ğŸ‘‰</a><a href="https://github.com/zhaohaihao/java-design-patterns/tree/master/105-Singleton" target="_blank" rel="noopener"><strong>æ–‡ç« ç¤ºä¾‹ä»£ç </strong></a><a href="https://emojipedia.org/backhand-index-pointing-left/" target="_blank" rel="noopener">ğŸ‘ˆ</a></p>
<h1 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h1><blockquote>
<p>ä¿è¯ä¸€ä¸ªç±»æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶ä¸”æä¾›ä¸€ä¸ªå¯ä»¥è®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹ã€‚</p>
</blockquote>
<h1 id="ä¸‰ä¸ªåŸºæœ¬æ­¥éª¤"><a href="#ä¸‰ä¸ªåŸºæœ¬æ­¥éª¤" class="headerlink" title="ä¸‰ä¸ªåŸºæœ¬æ­¥éª¤"></a>ä¸‰ä¸ªåŸºæœ¬æ­¥éª¤</h1><p>å®ç°å•ä¾‹æ¨¡å¼æœ‰ä¸‰ä¸ªåŸºæœ¬çš„æ­¥éª¤ï¼š</p>
<ol>
<li>ç§æœ‰æ„é€ æ–¹æ³•ç”¨æ¥é™åˆ¶å¤–éƒ¨ç±»å¯¹å…¶ç›´æ¥å®ä¾‹åŒ–</li>
<li>æä¾›ä¸€ä¸ªç§æœ‰é™æ€å½“å‰ç±»çš„å¯¹è±¡ä½œä¸ºå˜é‡</li>
<li>æä¾›ä¸€ä¸ªå…¬æœ‰é™æ€æ–¹æ³•è¿”å›ç±»çš„å®ä¾‹</li>
</ol>
<h1 id="å®ç°å•ä¾‹æ¨¡å¼çš„å‡ ç§æ–¹å¼"><a href="#å®ç°å•ä¾‹æ¨¡å¼çš„å‡ ç§æ–¹å¼" class="headerlink" title="å®ç°å•ä¾‹æ¨¡å¼çš„å‡ ç§æ–¹å¼"></a>å®ç°å•ä¾‹æ¨¡å¼çš„å‡ ç§æ–¹å¼</h1><h2 id="æ‡’æ±‰å¼"><a href="#æ‡’æ±‰å¼" class="headerlink" title="æ‡’æ±‰å¼"></a>æ‡’æ±‰å¼</h2><p>æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼åœ¨ç±»åˆ›å»ºçš„æ—¶å€™ä¸ä¼šåˆ›å»ºå®ä¾‹ï¼Œå› æ­¤ç±»çš„åŠ è½½é€Ÿåº¦æ¯”è¾ƒå¿«ã€‚</p>
<p>æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨çš„æ—¶å€™æ‰è¿›è¡Œåˆå§‹åŒ–ï¼Œè¿™æ ·åšé¿å…äº†å†…å­˜çš„æµªè´¹ã€‚ </p>
<p>ä½¿ç”¨æ‡’æ±‰å¼æ–¹æ³•åˆ›å»ºçš„ <code>LazySingleton</code> ç±»å®ä¾‹ä»£ç :</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> zhh</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å•ä¾‹æ¨¡å¼-æ‡’æ±‰å¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020-02-11 19:56</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LazySingleton</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> LazySingleton instance = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">LazySingleton</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> LazySingleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">            instance = <span class="keyword">new</span> LazySingleton();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ç§æ–¹å¼å…¶å®æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ã€‚</p>
<p>åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œè¿™ç§æ–¹å¼å¯ä»¥å¾ˆå¥½åœ°è¿›è¡Œå¤„ç†ã€‚ä½†æ˜¯åœ¨å¤šçº¿ç¨‹çš„ç¯å¢ƒä¸‹ï¼Œè¿™ç§æ–¹å¼å°±ä¼šå‡ºç°é—®é¢˜ã€‚</p>
<p>å‡è®¾ç°åœ¨æœ‰ä¸¤ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªçº¿ç¨‹Aï¼Œå¦ä¸€ä¸ªçº¿ç¨‹Bã€‚å½“çº¿ç¨‹Aåˆ°è¾¾ <code>instance = new LazySingleton();</code> è¿™ä¸€è¡Œä½†æ²¡æœ‰æ‰§è¡Œè¿™ä¸€è¡Œçš„åŒæ—¶ï¼Œçº¿ç¨‹Båˆ°è¾¾äº† <code>if (instance == null)</code> è¿™ä¸ªåˆ¤æ–­ã€‚æ­¤æ—¶ç”±äºçº¿ç¨‹Aè¿˜æœªæ‰§è¡Œå½“å‰è¡Œï¼Œçº¿ç¨‹Bçš„åˆ¤æ–­ç»“æœä¸º <code>true</code> ï¼Œæ‰€ä»¥çº¿ç¨‹Bä¾æ—§å¯ä»¥æ‰§è¡Œ <code>instance = new LazySingleton();</code> è¿™ä¸€è¡Œè¯­å¥ã€‚æ­¤æ—¶è¿™ä¸¤ä¸ªçº¿ç¨‹ä¼šè·å¾—å•ä¾‹ç±» <code>LazySingleton</code> çš„ä¸¤ä¸ªä¸åŒå®ä¾‹ï¼Œä»è€Œè¿›ä¸€æ­¥ç ´åäº†å•ä¾‹æ¨¡å¼ã€‚</p>
<h3 id="æ”¹è¿›æ–¹å¼ä¸€-åŠ åŒæ­¥é”"><a href="#æ”¹è¿›æ–¹å¼ä¸€-åŠ åŒæ­¥é”" class="headerlink" title="æ”¹è¿›æ–¹å¼ä¸€ (åŠ åŒæ­¥é”)"></a>æ”¹è¿›æ–¹å¼ä¸€ (åŠ åŒæ­¥é”)</h3><p>åœ¨ <code>getInstance()</code> æ–¹æ³•ä¸Šæ·»åŠ  <code>synchronized</code> å…³é”®å­—ï¼Œä½¿å¾—å½“å‰çš„æ–¹æ³•å˜æˆåŒæ­¥æ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> zhh</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å•ä¾‹æ¨¡å¼-æ‡’æ±‰å¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020-02-11 19:56</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LazySingleton</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> LazySingleton instance = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">LazySingleton</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> LazySingleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">            instance = <span class="keyword">new</span> LazySingleton();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>synchronized</code> åŠ åœ¨é™æ€æ–¹æ³•ä¸Šï¼Œç›¸å½“äºé”çš„æ˜¯å½“å‰ç±»çš„classæ–‡ä»¶ã€‚</p>
<h3 id="æ”¹è¿›æ–¹å¼äºŒ-åŠ åŒæ­¥é”"><a href="#æ”¹è¿›æ–¹å¼äºŒ-åŠ åŒæ­¥é”" class="headerlink" title="æ”¹è¿›æ–¹å¼äºŒ (åŠ åŒæ­¥é”)"></a>æ”¹è¿›æ–¹å¼äºŒ (åŠ åŒæ­¥é”)</h3><p>åœ¨ <code>getInstance()</code> æ–¹æ³•ä¸­æ·»åŠ  <code>synchronized</code> å—ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> zhh</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å•ä¾‹æ¨¡å¼-æ‡’æ±‰å¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020-02-11 19:56</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LazySingleton</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> LazySingleton instance = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">LazySingleton</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> LazySingleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (LazySingleton<span class="class">.<span class="keyword">class</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">                instance = <span class="keyword">new</span> LazySingleton();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ç§æ–¹å¼å’Œä¸Šè¿°æ”¹è¿›æ–¹å¼ä¸€çš„æ•ˆæœå®é™…ä¸Šæ˜¯ä¸€æ ·çš„ã€‚</p>
<p>åœ¨å¤šçº¿ç¨‹èµ„æºå…±äº«å½“ä¸­ï¼Œä½¿ç”¨ <code>synchronized</code> åŒæ­¥é”çš„æ–¹å¼ï¼Œå…¶å®å°±æ˜¯ä»¥<strong>æ—¶é—´æ¢ç©ºé—´</strong>çš„æ–¹å¼ã€‚</p>
<h2 id="åŒé‡æ£€æŸ¥æ‡’æ±‰å¼"><a href="#åŒé‡æ£€æŸ¥æ‡’æ±‰å¼" class="headerlink" title="åŒé‡æ£€æŸ¥æ‡’æ±‰å¼"></a>åŒé‡æ£€æŸ¥æ‡’æ±‰å¼</h2><p>åŒæ­¥é”æ˜¯æ¯”è¾ƒæ¶ˆè€—èµ„æºçš„ï¼Œä¼šå­˜åœ¨åŠ é”å’Œè§£é”çš„å¼€é”€ã€‚è€Œä¸”ä¸Šè¿°ä¸¤æ”¹è¿›æ–¹å¼ <code>synchronized</code> é”çš„æ˜¯classæ–‡ä»¶ï¼Œé”çš„ç²’åº¦èŒƒå›´è¾ƒå¤§ã€‚</p>
<p>ä¸ºäº†å…¼é¡¾æ€§èƒ½å’Œçº¿ç¨‹å®‰å…¨ï¼Œä½¿ç”¨åŒé‡æ£€æŸ¥çš„æ–¹å¼æ¥æ”¹è¿›æ‡’æ±‰å¼ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> zhh</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å•ä¾‹æ¨¡å¼-æ‡’æ±‰å¼(åŒé‡æ£€æŸ¥)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020-02-11 19:56</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LazySingleton</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> LazySingleton instance = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">LazySingleton</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> LazySingleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (LazySingleton<span class="class">.<span class="keyword">class</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (instance == <span class="keyword">null</span>)&#123;</span><br><span class="line">                    instance = <span class="keyword">new</span> LazySingleton();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¤–å±‚ <code>if (instance == null)</code> ä¸åŠ é”ï¼Œå¦‚æœä¸æ»¡è¶³åˆ™ç¨‹åºç›´æ¥è¿”å›ï¼Œå¦‚æœæ»¡è¶³åˆ™ä¹Ÿåªä¼šæœ‰ä¸€ä¸ªçº¿ç¨‹è¿›å…¥åˆ° <code>synchronized</code> å½“ä¸­ã€‚å¤§å¹…åº¦åœ°é™ä½äº†å°† <code>synchronized</code> åŠ åœ¨æ–¹æ³•ä¸Šæ—¶å¸¦æ¥çš„æ€§èƒ½å¼€é”€ã€‚</p>
<p>ä½†æ˜¯ç›®å‰è¿™ç§æ–¹å¼ä¾æ—§å­˜åœ¨éšæ‚£ã€‚ä¸»è¦åŸå› åœ¨äºå¤–å±‚ <code>if (instance == null)</code> åˆ†æ”¯åˆ¤æ–­å’Œ <code>instance = new LazySingleton()</code> è¯­å¥è¿™ä¸¤å¤„ã€‚</p>
<p>å¤–å±‚ <code>if (instance == null)</code> åœ¨è¿›è¡Œåˆ†æ”¯åˆ¤æ–­çš„æ—¶å€™ï¼Œ <code>instance</code> å¯¹è±¡æœ‰å¯èƒ½æ˜¯ä¸ä¸ºç©ºçš„ï¼Œè™½ç„¶ä¸ä¸ºç©ºï¼Œä½†æ˜¯å¾ˆæœ‰å¯èƒ½ <code>instance</code> è¿™ä¸ªå¯¹è±¡è¿˜æœªå®Œæˆåˆå§‹åŒ–ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬çš„ <code>instance = new LazySingleton()</code> è¯­å¥è¿˜æ²¡æœ‰æ‰§è¡Œå®Œæˆã€‚</p>
<p><strong>Qï¼šå¦‚ä½•ç†è§£ï¼Ÿ</strong></p>
<hr>
<p>æˆ‘ä»¬å¯ä»¥å…ˆæ¥çœ‹ä¸‹ <code>instance = new LazySingleton()</code> è¿™è¯­å¥ã€‚è™½ç„¶çœ‹ä¼¼ç®€å•çš„ä¸€è¡Œè¯­å¥ï¼Œä½†æ˜¯åœ¨ç¨‹åºä¸­è¿™æ¡è¯­å¥å®é™…ä¸Šè¿›è¡Œäº†ä¸‰ä¸ªæ“ä½œï¼š</p>
<ol>
<li>ç»™å½“å‰å¯¹è±¡åˆ†é…å†…å­˜</li>
<li>åˆå§‹åŒ–å¯¹è±¡</li>
<li>è®¾ç½®å˜é‡ <code>instance</code> æŒ‡å‘åˆšåˆ†é…çš„å†…å­˜åœ°å€</li>
</ol>
<p>åœ¨ç¨‹åºæ‰§è¡Œçš„è¿‡ç¨‹å½“ä¸­ï¼ŒJVMæœ‰å¯èƒ½ä¼šå‘ç”Ÿ<strong>æŒ‡ä»¤é‡æ’åº</strong>ã€‚æ¯”å¦‚å‘ç”ŸæŒ‡ä»¤é‡æ’åºåå½“å‰è¯­å¥çš„æ‰§è¡Œé¡ºåºå˜ä¸º132ï¼Œå³å…ˆç»™å¯¹è±¡åˆ†é…å†…å­˜åœ°å€ï¼Œç„¶åå°†å˜é‡æŒ‡å‘åˆšåˆ†é…çš„å†…å­˜åœ°å€ï¼Œæœ€åå†è¿›è¡Œå¯¹è±¡çš„åˆå§‹åŒ–æ“ä½œã€‚</p>
<p>ä¸Šè¿°æ“ä½œåœ¨å•çº¿ç¨‹ç¯å¢ƒä¸‹ä¹Ÿæ²¡ä»€ä¹ˆå¤§é—®é¢˜ã€‚ç„¶åæˆ‘ä»¬å†æ¥çœ‹çœ‹ï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œå½“å‰ç¨‹åºå­˜åœ¨éšæ‚£çš„å¯èƒ½ã€‚</p>
<table>
<thead>
<tr>
<th align="center">æ—¶é—´çº¿</th>
<th align="center">çº¿ç¨‹A</th>
<th align="center">çº¿ç¨‹B</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">ç»™å½“å‰å¯¹è±¡åˆ†é…å†…å­˜</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">è®¾ç½®å˜é‡ <code>instance</code> æŒ‡å‘åˆšåˆ†é…çš„å†…å­˜åœ°å€</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">3</td>
<td align="center"></td>
<td align="center">å¤–å±‚åˆ†æ”¯åˆ¤æ–­ <code>instance</code> æ˜¯å¦ä¸ºnull</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center"></td>
<td align="center">åˆæ¬¡è®¿é—®å¯¹è±¡</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">åˆå§‹åŒ–å¯¹è±¡</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">åˆæ¬¡è®¿é—®å¯¹è±¡</td>
<td align="center"></td>
</tr>
</tbody></table>
<p>æŒ‰ç…§æ—¶é—´çº¿çš„æ¨ç§»ï¼Œæˆ‘ä»¬å¯ä»¥ä»è¡¨æ ¼ä¸­çœ‹åˆ°åœ¨æ—¶é—´çº¿4ä¸­çº¿ç¨‹Bè®¿é—®çš„å¯¹è±¡æ˜¯çº¿ç¨‹Aä¸­è¿˜æœªåˆå§‹åŒ–å®Œæˆçš„å¯¹è±¡ï¼Œè¿™ä¸ªæ—¶å€™å°±æœ‰å¯èƒ½å‘ç”Ÿå¼‚å¸¸ã€‚</p>
<p>è¿™é‡Œå®é™…ä¸Šæœ‰ä¸¤ç§æ–¹å¼å¯ä»¥è§£å†³ä»¥ä¸Šé—®é¢˜ï¼š</p>
<ul>
<li>é˜²æ­¢æŒ‡ä»¤é‡æ’åº</li>
<li>è®©å…¶ä½™çš„çº¿ç¨‹æ— æ³•è§‚å¯Ÿåˆ°å½“å‰çº¿ç¨‹çš„æŒ‡ä»¤é‡æ’åº</li>
</ul>
<p><strong>Qï¼šå¦‚ä½•é¿å…æŒ‡ä»¤é‡æ’åºï¼Ÿ</strong></p>
<hr>
<p>ä½¿ç”¨ <code>volatile</code> å…³é”®å­—æ¥å£°æ˜ <code>instance</code> å˜é‡ï¼Œè¿™æ ·çš„è¯é‡æ’åºå°±ä¼šè¢«ç¦æ­¢ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LazySingleton</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> LazySingleton instance = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">LazySingleton</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> LazySingleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (LazySingleton<span class="class">.<span class="keyword">class</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (instance == <span class="keyword">null</span>)&#123;</span><br><span class="line">                    instance = <span class="keyword">new</span> LazySingleton();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>CPUä¹Ÿæœ‰å…±äº«å†…å­˜ã€‚åœ¨åŠ äº† <code>volatile</code> å…³é”®å­—ä¹‹åï¼Œæ‰€æœ‰çš„çº¿ç¨‹éƒ½èƒ½è§‚å¯Ÿåˆ°å…±äº«å†…å­˜çš„æœ€æ–°çŠ¶æ€ï¼Œä¿è¯äº†å†…å­˜çš„å¯è§æ€§ã€‚</p>
<h2 id="é™æ€å†…éƒ¨ç±»æ¨¡å¼"><a href="#é™æ€å†…éƒ¨ç±»æ¨¡å¼" class="headerlink" title="é™æ€å†…éƒ¨ç±»æ¨¡å¼"></a>é™æ€å†…éƒ¨ç±»æ¨¡å¼</h2><p>è¿™ç§æ–¹å¼ï¼Œå…¶å®å°±æ˜¯è®©å…¶ä½™çš„çº¿ç¨‹æ— æ³•è§‚å¯Ÿåˆ°å½“å‰çº¿ç¨‹çš„æŒ‡ä»¤é‡æ’åºã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> zhh</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020-02-12 01:36</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StaticInnerClassSingleton</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonHolder</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> StaticInnerClassSingleton instance = <span class="keyword">new</span> StaticInnerClassSingleton();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">StaticInnerClassSingleton</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> StaticInnerClassSingleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> SingletonHolder.instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>JVMåœ¨ç±»çš„åˆå§‹åŒ–é˜¶æ®µ(å³Classåœ¨è¢«ç±»åŠ è½½å™¨åŠ è½½ä¹‹åï¼Œåœ¨è¢«çº¿ç¨‹ä½¿ç”¨ä¹‹å‰è¿™ä¸€æœŸé—´)ä¼šå»æ‰§è¡Œç±»çš„åˆå§‹åŒ–ã€‚</p>
<p>åœ¨ç±»çš„åˆå§‹åŒ–æœŸé—´ï¼ŒJVMä¼šå»è·å–Classå¯¹è±¡çš„åˆå§‹åŒ–é”(åŒæ­¥å¤šä¸ªçº¿ç¨‹å¯¹ä¸€ä¸ªç±»çš„åˆå§‹åŒ–)ã€‚</p>
<p>åˆå§‹åŒ–ä¸€ä¸ªç±»ï¼ŒåŒ…æ‹¬æ‰§è¡Œç±»çš„é™æ€åˆå§‹åŒ–ï¼Œåˆå§‹åŒ–ç±»ä¸­å£°æ˜çš„é™æ€å˜é‡ã€‚<br>æ ¹æ®Javaè¯­è¨€è§„èŒƒä¸»è¦æœ‰äº”ç§æƒ…å†µåœ¨é¦–æ¬¡å‘ç”Ÿæ—¶ï¼Œä¸€ä¸ªç±»(åŒ…æ‹¬æ¥å£)å°†è¢«ç«‹åˆ»åˆå§‹åŒ–ã€‚ä»¥ <code>Clazz</code> ç±»ä¸ºä¾‹ï¼š</p>
<ul>
<li>æœ‰ä¸€ä¸ª <code>Clazz</code> ç±»å‹çš„å®ä¾‹è¢«åˆ›å»º</li>
<li><code>Clazz</code> ç±»ä¸­å£°æ˜çš„ä¸€ä¸ªé™æ€æ–¹æ³•è¢«è°ƒç”¨</li>
<li><code>Clazz</code> ç±»ä¸­å£°æ˜çš„ä¸€ä¸ªé™æ€æˆå‘˜è¢«èµ‹å€¼</li>
<li><code>Clazz</code> ç±»ä¸­çš„é™æ€æˆå‘˜è¢«ä½¿ç”¨ï¼Œå¹¶ä¸”è¿™ä¸ªæˆå‘˜ä¸æ˜¯ä¸€ä¸ªå¸¸é‡æˆå‘˜</li>
<li><code>Clazz</code> ç±»æ˜¯ä¸€ä¸ªé¡¶çº§ç±»ï¼Œå¹¶ä¸” <code>Clazz</code> ç±»ä¸­æœ‰åµŒå¥—çš„æ–­è¨€è¯­å¥</li>
</ul>
<p>é€šè¿‡æ”¹åŠ¨åŒé‡æ£€æŸ¥æ‡’æ±‰å¼ä¸­çº¿ç¨‹Aå’Œçº¿ç¨‹Bçš„æµç¨‹ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸‹å›¾ã€‚</p>
<p><img src="https://oss.zhaohaihao.com/photo/design-patterns/singleton/singleton01.png?x-oss-process=style/style01" alt=""><br>é€šè¿‡ä¸Šå›¾ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†æä¸‹ï¼šå½“çº¿ç¨‹Aå’Œçº¿ç¨‹Bå°è¯•è·å– <code>Class</code> å¯¹è±¡çš„åˆå§‹åŒ–é”ï¼Œå‡è®¾çº¿ç¨‹Aè·å–åˆ°äº†è¿™ä¸ªé”ï¼Œæ­¤æ—¶çº¿ç¨‹Aæ‰§è¡Œé™æ€å†…éƒ¨ç±»çš„åˆå§‹åŒ–æ“ä½œã€‚ç”±äº <code>Class</code> å¯¹è±¡åˆå§‹åŒ–é”çš„å­˜åœ¨ï¼Œçº¿ç¨‹Bæ˜¯æ— æ³•çœ‹åˆ°ç±»åˆå§‹åŒ–æ“ä½œä¸­çš„æŒ‡ä»¤é‡æ’åºçš„ã€‚</p>
<h2 id="é¥¿æ±‰å¼"><a href="#é¥¿æ±‰å¼" class="headerlink" title="é¥¿æ±‰å¼"></a>é¥¿æ±‰å¼</h2><p>é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼æ­£å¥½ä¸æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼ç›¸åã€‚</p>
<p>é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼åœ¨ç±»åŠ è½½çš„æ—¶å€™å°±å®Œæˆäº†åˆå§‹åŒ–æ“ä½œï¼Œé¿å…äº†çº¿ç¨‹åŒæ­¥çš„é—®é¢˜ã€‚æ‰€ä»¥ç±»åœ¨åŠ è½½çš„æ—¶å€™æ¯”è¾ƒç¼“æ…¢ï¼Œè€Œåœ¨è¿è¡Œæ—¶è·å–å¯¹è±¡çš„é€Ÿåº¦ç›¸å¯¹è¾ƒå¿«ã€‚ </p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> zhh</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å•ä¾‹æ¨¡å¼-é¥¿æ±‰å¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020-02-12 12:59</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HungrySingleton</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> HungrySingleton instance = <span class="keyword">new</span> HungrySingleton();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">HungrySingleton</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> HungrySingleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼çš„é—®é¢˜å°±åœ¨äºç±»åœ¨åŠ è½½çš„æ—¶å€™å°±è¿›è¡Œåˆå§‹åŒ–æ“ä½œï¼Œæ²¡æœ‰è¾¾åˆ°æ‡’åŠ è½½çš„æ•ˆæœã€‚å¦‚æœç±»ä»å§‹è‡³ç»ˆéƒ½æœªæ›¾ä½¿ç”¨è¿‡ï¼Œé‚£ä¹ˆå°±é€ æˆäº†èµ„æºçš„æµªè´¹ã€‚ </p>
<p>å½“ç„¶ä¹Ÿå¯ä»¥æŠŠå¯¹è±¡å®ä¾‹åŒ–çš„è¿‡ç¨‹æ”¾å…¥åˆ°é™æ€å—å½“ä¸­ï¼Œæ•ˆæœä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> zhh</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å•ä¾‹æ¨¡å¼-é¥¿æ±‰å¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020-02-12 12:59</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HungrySingleton</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> HungrySingleton instance;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        instance = <span class="keyword">new</span> HungrySingleton();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">HungrySingleton</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> HungrySingleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æšä¸¾æ¨¡å¼"><a href="#æšä¸¾æ¨¡å¼" class="headerlink" title="æšä¸¾æ¨¡å¼"></a>æšä¸¾æ¨¡å¼</h2><p>æšä¸¾æ–¹å¼æ˜¯ã€ŠEffective Javaã€‹ä½œè€…Josh Blochæ¨èçš„æ–¹å¼ã€‚</p>
<p>è¿™ç§æ–¹å¼ä¸ä»…èƒ½é¿å…å¤šçº¿ç¨‹åŒæ­¥çš„é—®é¢˜ï¼Œè€Œä¸”è¿˜èƒ½é˜²æ­¢åºåˆ—åŒ–å’Œåå°„ç ´åå•ä¾‹åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> zhh</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æšä¸¾å•ä¾‹æ¨¡å¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020-02-12 16:08</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> EnumSingleton &#123;</span><br><span class="line">    INSTANCE;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ä»»ä½•å…¶ä»–æ–¹æ³•"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> zhh</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æšä¸¾å•ä¾‹æ¨¡å¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020-02-12 16:08</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> EnumSingleton &#123;</span><br><span class="line">    INSTANCE &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            System.out.println(<span class="string">"ä»»ä½•å…¶ä»–æ–¹æ³•"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">method</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šçš„ä¸¤ç§æ–¹å¼å‡å¯ï¼Œæ•ˆæœä¸€æ ·ã€‚</p>
<h2 id="å®¹å™¨å•ä¾‹"><a href="#å®¹å™¨å•ä¾‹" class="headerlink" title="å®¹å™¨å•ä¾‹"></a>å®¹å™¨å•ä¾‹</h2><p>è¿™ç§å•ä¾‹æ¨¡å¼å’Œäº«å…ƒæ¨¡å¼æœ‰ç‚¹ç±»ä¼¼ã€‚åˆ©ç”¨å®¹å™¨æ¥ç®¡ç†å¤šä¸ªå•ä¾‹å¯¹è±¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> zhh</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å®¹å™¨å•ä¾‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020-02-12 16:28</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ContainerSingleton</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">ContainerSingleton</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">putInstance</span><span class="params">(String key, Object instance)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isNotBlank(key) &amp;&amp; instance != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!map.containsKey(key)) &#123;</span><br><span class="line">                map.put(key, instance);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">getInstance</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> map.get(key);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ç§æ–¹å¼æ¯”è¾ƒé€‚åˆç¨‹åºåœ¨åˆå§‹åŒ–æœŸé—´å¤šä¸ªå•ä¾‹å­˜æ”¾è‡³å®¹å™¨è¿›è¡Œç»Ÿä¸€ç®¡ç†ï¼Œä½¿ç”¨æ—¶é€šè¿‡é”®å€¼ä»å®¹å™¨ä¸­è·å–å•ä¾‹å¯¹è±¡ã€‚</p>
<p>è¿™é‡Œçš„å®¹å™¨ä½¿ç”¨çš„æ˜¯ <code>HashMap</code> ï¼Œå¾ˆæ˜¾ç„¶æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ã€‚ä½†æ˜¯å¯¹ä¸Šè¿°ç”¨ä¾‹(ç¨‹åºåœ¨åˆå§‹åŒ–æœŸé—´å¤šä¸ªå•ä¾‹å­˜æ”¾è‡³å®¹å™¨è¿›è¡Œç»Ÿä¸€ç®¡ç†ï¼Œä½¿ç”¨æ—¶é€šè¿‡é”®å€¼ä»å®¹å™¨ä¸­è·å–å•ä¾‹å¯¹è±¡)è¿™æ ·ä½¿ç”¨ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p>
<p>ä¸ºäº†çº¿ç¨‹å®‰å…¨ï¼Œæˆ‘ä»¬å¯ä»¥æ”¹ç”¨ <code>HashTable</code> ã€‚ä½†æ˜¯ <code>HashTable</code> ä¼šå½±å“æ€§èƒ½ï¼Œåœ¨é¢‘ç¹åœ°å­˜å–æ—¶éƒ½ä¼šæœ‰åŒæ­¥é”ã€‚ä¹Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨ <code>ConcurrentHashMap</code> ã€‚</p>
<h2 id="ThreadLocalçº¿ç¨‹å•ä¾‹"><a href="#ThreadLocalçº¿ç¨‹å•ä¾‹" class="headerlink" title="ThreadLocalçº¿ç¨‹å•ä¾‹"></a>ThreadLocalçº¿ç¨‹å•ä¾‹</h2><p>è¿™ç§æ–¹å¼äº§ç”Ÿçš„å•ä¾‹å¹¶ä¸èƒ½ä¿è¯åœ¨æ•´ä¸ªåº”ç”¨ä¸­å…¨å±€å”¯ä¸€ï¼Œä½†æ˜¯å®ƒå¯ä»¥ä¿è¯åœ¨åŒä¸ªçº¿ç¨‹å½“ä¸­å”¯ä¸€ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> zhh</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ThreadLocalçº¿ç¨‹å•ä¾‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020-02-12 17:03</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadLocalSingleton</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> ThreadLocal&lt;ThreadLocalSingleton&gt; THREAD_LOCAL = <span class="keyword">new</span> ThreadLocal&lt;ThreadLocalSingleton&gt;() &#123;</span><br><span class="line">        <span class="comment">// é‡å†™åˆå§‹åŒ–æ–¹æ³•</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> ThreadLocalSingleton <span class="title">initialValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> ThreadLocalSingleton();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">ThreadLocalSingleton</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ThreadLocalSingleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> THREAD_LOCAL.get();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>ThreadLocal</code> ä¼šä¸ºæ¯ä¸ªçº¿ç¨‹æä¾›ä¸€ä¸ªç‹¬ç«‹çš„å˜é‡å‰¯æœ¬ã€‚<code>ThreadLocal</code> æ˜¯åŸºäº <code>ThreadLocalMap</code> è¿™ä¸ªç±»æ¥å®ç°çš„ï¼Œå®ƒç»´æŒäº†çº¿ç¨‹é—´çš„éš”ç¦»ã€‚å½“è°ƒç”¨ <code>ThreadLocal</code> çš„ <code>get()</code> æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬ä¸ç”¨æŒ‡å®šé”®å€¼ï¼Œé»˜è®¤èµ°çš„å°±æ˜¯ <code>ThreadLocalMap</code> ã€‚</p>
<p><code>ThreadLocal</code> éš”ç¦»äº†å¤šä¸ªçº¿ç¨‹å¯¹æ•°æ®è®¿é—®çš„å†²çªã€‚åœ¨å¤šçº¿ç¨‹èµ„æºå…±äº«å½“ä¸­ï¼Œä½¿ç”¨ <code>ThreadLocal</code> çš„æ–¹å¼ï¼Œå…¶å®å°±æ˜¯ä»¥<strong>ç©ºé—´æ¢æ—¶é—´</strong>çš„æ–¹å¼ã€‚</p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><h2 id="é€‚ç”¨åœºæ™¯"><a href="#é€‚ç”¨åœºæ™¯" class="headerlink" title="é€‚ç”¨åœºæ™¯"></a>é€‚ç”¨åœºæ™¯</h2><ul>
<li>åœ¨åº”ç”¨åœºæ™¯ä¸­ï¼ŒæŸç±»åªè¦æ±‚ç”Ÿæˆä¸€ä¸ªå®ä¾‹çš„æ—¶å€™ã€‚ä¾‹å¦‚ä¸€ä¸ªç­ä¸­çš„ç­é•¿ã€æ¯ä¸ªäººçš„èº«ä»½è¯å·ç­‰ã€‚</li>
<li>å½“å¯¹è±¡éœ€è¦è¢«å…±äº«çš„åœºåˆã€‚ç”±äºå•ä¾‹æ¨¡å¼åªå…è®¸åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œå…±äº«è¯¥å¯¹è±¡å¯ä»¥èŠ‚çœå†…å­˜ï¼Œå¹¶ä¸”åŠ å¿«å¯¹è±¡è®¿é—®é€Ÿåº¦ã€‚ä¾‹å¦‚Webä¸­çš„é…ç½®å¯¹è±¡ã€æ•°æ®åº“çš„è¿æ¥æ± ç­‰ã€‚</li>
<li>å½“æŸç±»éœ€è¦é¢‘ç¹è¿›è¡Œå®ä¾‹åŒ–æ“ä½œï¼Œè€Œåˆ›å»ºçš„å¯¹è±¡åˆé¢‘ç¹è¢«é”€æ¯çš„æ—¶å€™ã€‚ä¾‹å¦‚å¤šçº¿ç¨‹çš„çº¿ç¨‹æ± ã€ç½‘ç»œè¿æ¥æ± ç­‰ã€‚</li>
</ul>
<h2 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h2><ul>
<li>åœ¨å†…å­˜ä¸­åªå­˜åœ¨ä¸€ä¸ªå®ä¾‹ï¼Œå‡å°‘äº†å†…å­˜å¼€é”€ã€‚</li>
<li>é¿å…å¯¹å…±äº«èµ„æºçš„å¤šé‡å ç”¨ã€‚</li>
<li>è®¾ç½®å…¨å±€è®¿é—®ç‚¹ï¼Œä¸¥æ ¼æ§åˆ¶è®¿é—®ã€‚</li>
</ul>
<h2 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h2><ul>
<li>æ²¡æœ‰æŠ½è±¡å±‚ï¼Œæ‰©å±•å›°éš¾ã€‚</li>
<li>å•ä¾‹ç±»çš„èŒè´£è¿‡é‡ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šè¿èƒŒäº†â€œå•ä¸€èŒè´£åŸåˆ™â€ã€‚ </li>
<li>ä¸é€‚ç”¨äºå˜åŒ–çš„å¯¹è±¡ï¼Œå¦‚æœåŒä¸€ç±»å‹çš„å¯¹è±¡æ€»æ˜¯è¦åœ¨ä¸åŒçš„ç”¨ä¾‹åœºæ™¯å‘ç”Ÿå˜åŒ–ï¼Œå•ä¾‹å°±ä¼šå¼•èµ·æ•°æ®çš„é”™è¯¯ï¼Œä¸èƒ½ä¿å­˜å½¼æ­¤çš„çŠ¶æ€ã€‚ </li>
<li>æ»¥ç”¨å•ä¾‹å°†å¸¦æ¥ä¸€äº›è´Ÿé¢é—®é¢˜ï¼Œå¦‚ä¸ºäº†èŠ‚çœèµ„æºå°†æ•°æ®åº“è¿æ¥æ± å¯¹è±¡è®¾è®¡ä¸ºçš„å•ä¾‹ç±»ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…±äº«è¿æ¥æ± å¯¹è±¡çš„ç¨‹åºè¿‡å¤šè€Œå‡ºç°è¿æ¥æ± æº¢å‡ºï¼›å¦‚æœå®ä¾‹åŒ–çš„å¯¹è±¡é•¿æ—¶é—´ä¸è¢«åˆ©ç”¨ï¼Œç³»ç»Ÿä¼šè®¤ä¸ºæ˜¯åƒåœ¾è€Œè¢«å›æ”¶ï¼Œè¿™å°†å¯¼è‡´å¯¹è±¡çŠ¶æ€çš„ä¸¢å¤±ã€‚ </li>
</ul>
<h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><ul>
<li>ã€ŠHead First è®¾è®¡æ¨¡å¼ã€‹</li>
<li>ã€Šå¤§è¯è®¾è®¡æ¨¡å¼ã€‹</li>
<li>ã€ŠEffective Javaã€‹</li>
<li><a href="https://zh.wikipedia.org/wiki/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F" target="_blank" rel="noopener">ç»´åŸºç™¾ç§‘-å•ä¾‹æ¨¡å¼</a></li>
<li><a href="https://book.51cto.com/art/201511/498717.htm?pc" target="_blank" rel="noopener">ä½¿ç”¨å®¹å™¨å®ç°å•ä¾‹æ¨¡å¼</a></li>
<li><a href="https://www.jianshu.com/p/6521ccac486d" target="_blank" rel="noopener">å®¹å™¨å•ä¾‹å’ŒThreadLocalå•ä¾‹</a></li>
<li><a href="https://blog.csdn.net/wu2374633583/article/details/80880203" target="_blank" rel="noopener">å¤šçº¿ç¨‹ä¹‹ThreadLocalå•ä¾‹æ¨¡å¼</a></li>
<li><a href="https://blog.csdn.net/yejingtao703/article/details/78806902" target="_blank" rel="noopener">ThreadLocal-å•ä¾‹æ¨¡å¼ä¸‹é«˜å¹¶å‘çº¿ç¨‹å®‰å…¨</a></li>
</ul>

        </div>

        
            <section class="post-copyright">
            
                
                
                
                

                
                    <p class="copyright-item" style="text-align: center; margin: 20px 0px;">
                        <span>Â© è½¬è½½è¯·ä¿ç•™æœ¬æ–‡åœ°å€, è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰</span>
                    </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <!--<span>Tag(s):</span>-->
                <span class="tag">
                    
                    
                      <i class="iconfont icon-tag"></i> <a href="https://www.zhaohaihao.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">è®¾è®¡æ¨¡å¼</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">è¿”å›ä¸Šå±‚</a>
                <span>Â· </span>
                <a href="https://www.zhaohaihao.com/">è¿”å›ä¸»é¡µ</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="https://www.zhaohaihao.com/posts/2020021301.html">è®¾è®¡æ¨¡å¼ä¹‹åˆ›å»ºå‹-åŸå‹æ¨¡å¼ (Prototype)</a>
            
            
            <a class="next" rel="next" href="https://www.zhaohaihao.com/posts/2020021102.html">è®¾è®¡æ¨¡å¼ä¹‹åˆ›å»ºå‹-å»ºé€ è€…æ¨¡å¼ (Builder)</a>
            
        </section>


    </article>
</div>

        </div>
        
	<footer id="footer" class="footer" style="line-height: unset;">
	    <div class="copyright" style="text-align: center;">
	        æœ¬ç«™å·²å®‰å…¨è¿è¡Œ <span id="htmer_time">0å¹´293å¤©1æ—¶59åˆ†51ç§’</span></br>
            <span id="busuanzi_container_site_pv">æ€»è®¿é—®é‡ <span id="busuanzi_value_site_pv"></span> æ¬¡</span>
            |
            <span id="busuanzi_container_site_uv">æ€»è®¿å®¢æ•° <span id="busuanzi_value_site_uv"></span> äºº</span>
            |
            æ€»å­—æ•° 42.7k å­—  <a href="https://zhaohaihao.com/atom.xml" target="_blank"><i class="iconfont icon-RSS"></i></a> </br>
	        <span>Â© 2019-2020 Horace&#39;s Blog.</span> <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow">æµ™ICPå¤‡18055264å·</a>
	    </div>
	</footer>

    <style>
        .icon-RSS {
            color: #FD9B00;
        }
    </style>

	<script language="javascript">
    function siteTime(){
        window.setTimeout("siteTime()", 1000);
        var seconds = 1000;
        var minutes = seconds * 60;
        var hours = minutes * 60;
        var days = hours * 24;
        var years = days * 365;
        var today = new Date();
        var todayYear = today.getFullYear();
        var todayMonth = today.getMonth()+1;
        var todayDate = today.getDate();
        var todayHour = today.getHours();
        var todayMinute = today.getMinutes();
        var todaySecond = today.getSeconds();
        /* Date.UTC() -- è¿”å›dateå¯¹è±¡è·ä¸–ç•Œæ ‡å‡†æ—¶é—´(UTC)1970å¹´1æœˆ1æ—¥åˆå¤œä¹‹é—´çš„æ¯«ç§’æ•°(æ—¶é—´æˆ³)
        year - ä½œä¸ºdateå¯¹è±¡çš„å¹´ä»½ï¼Œä¸º4ä½å¹´ä»½å€¼
        month - 0-11ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„æœˆä»½
        day - 1-31ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„å¤©æ•°
        hours - 0(åˆå¤œ24ç‚¹)-23ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„å°æ—¶æ•°
        minutes - 0-59ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„åˆ†é’Ÿæ•°
        seconds - 0-59ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„ç§’æ•°
        microseconds - 0-999ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„æ¯«ç§’æ•° */
        var t1 = Date.UTC(2019,6,12,22,22,22); //åŒ—äº¬æ—¶é—´2016-12-1 00:00:00
        var t2 = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
        var diff = t2-t1;
        var diffYears = Math.floor(diff/years);
        var diffDays = Math.floor((diff/days)-diffYears*365);
        var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
        var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
        var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);
        document.getElementById("htmer_time").innerHTML=diffYears+"å¹´"+diffDays+"å¤©"+diffHours+"æ—¶"+diffMinutes+"åˆ†"+diffSeconds+"ç§’";
    }
    siteTime();
</script>

    </div>
</body>
</html>
